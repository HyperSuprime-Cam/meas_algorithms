# -*- python -*-
Import("env")

env.CheckSwig("python", ilang="c++",
              includedProducts="utils")

testLib = env.LoadableModuleIncomplete("_testLib", ["testLib.i"],
                                       LIBS=env.getlibs("meas_algorithms"))
#
# Tests
#
import lsst.tests

tests = lsst.tests.Control(env,
                           ignoreList=["testLib.py", "SillyCentroid.cc", "Measure_1.cc"],
                           expectedFailures={})

#for fileName in glob.glob("*.cc"):
#    if re.search(r"^Measure_1\.cc$", os.path.basename(fileName)):
#        continue
#    env.Program(fileName, LIBS=env.getlibs("afw","meas_algorithms"))

tests.run("*.cc")

env.CheckSwig("python", ilang="c++", includedProducts="utils pex_logging")
for target in tests.run("*.py"):
    env.Depends(target, "../python/lsst/meas/algorithms/_algorithmsLib%s" % (env['LDMODULESUFFIX']))

    if target.endswith("centroidAlgorithms.py"):
        env.Depends(target, "_testLib%s" % (env["LDMODULESUFFIX"]))
        env.Depends(target, "testLib.py")

